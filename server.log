Setting up logging...
2025-12-07 16:43:11 - indextts - INFO - Logging initialized. Level: INFO, Log file: logs/indextts.log
Importing IndexTTS2...
Importing omegaconf...
Importing indextts.gpt.model_v2...
Importing transformers...
Importing GPT2Config...
Importing Cache...
Importing GenerationMixin...
Importing GPT2PreTrainedModel...
transformers_gpt2: Importing torch...
transformers_gpt2: Importing transformers.activations...
transformers_gpt2: Importing local generation utils...
transformers_gpt2: Importing local modeling utils...
transformers_modeling_utils: Importing standard libs...
transformers_modeling_utils: Importing torch...
transformers_modeling_utils: Importing GenerationMixin...
transformers_modeling_utils: Importing integrations...
transformers_modeling_utils: Importing utils...
transformers_modeling_utils: Imports done.
transformers_modeling_utils: Importing hub...
transformers_modeling_utils: Importing import_utils...
transformers_modeling_utils: Importing quantization_config...
transformers_modeling_utils: All imports done.
transformers_gpt2: Importing attn_mask_utils...
transformers_gpt2: Importing pytorch_utils...
transformers_gpt2: Imports done.
Importing Conformer/Perceiver...
Finished importing indextts.gpt.model_v2
Importing indextts.utils.maskgct_utils...
Importing indextts.utils.checkpoint...
Importing indextts.utils.front...
Importing indextts.s2mel.modules...
Importing transformers/modelscope...
Imports done.
IndexTTS2 imported.
Starting Uvicorn...
INFO:     Started server process [204040]
INFO:     Waiting for application startup.
Loading IndexTTS2 model...
Using device: cuda:0
2025-12-07 16:43:16 - indextts - INFO - Loading QwenEmotion from checkpoints/qwen0.6bemo4-merge/
2025-12-07 16:43:17 - indextts - INFO - Loaded QwenTokenizer
2025-12-07 16:43:18 - indextts - INFO - Loaded QwenModel
2025-12-07 16:43:18 - indextts - INFO - Initializing UnifiedVoice...
2025-12-07 16:43:29 - indextts - INFO - Loading checkpoint from checkpoints/gpt.pth...
2025-12-07 16:43:38 - indextts - INFO - Moving GPT to cuda:0...
2025-12-07 16:43:39 - indextts - INFO - Converting GPT to fp16...
2025-12-07 16:43:39 - indextts - INFO - >> GPT weights restored from: checkpoints/gpt.pth
2025-12-07 16:43:39 - indextts - INFO - GPT config post-initialized
2025-12-07 16:43:39 - indextts - INFO - Loading Feature Extractor...
2025-12-07 16:43:39 - indextts - INFO - >> Loaded Feature Extractor
2025-12-07 16:43:42 - indextts - INFO - >> Loaded Semantic Model
2025-12-07 16:43:43 - indextts - INFO - >> semantic_codec weights restored from: ./checkpoints/hf_cache/models--amphion--MaskGCT/snapshots/265c6cef07625665d0c28d2faafb1415562379dc/semantic_codec/model.safetensors
cfm loaded
length_regulator loaded
gpt_layer loaded
2025-12-07 16:43:46 - indextts - INFO - >> s2mel weights restored from: checkpoints/s2mel.pth
2025-12-07 16:43:47 - indextts - INFO - >> campplus_model weights restored from: ./checkpoints/hf_cache/models--funasr--campplus/snapshots/fb71fe990cbf6031ae6987a2d76fe64f94377b7e/campplus_cn_common.bin
Loading weights from nvidia/bigvgan_v2_22khz_80band_256x
Removing weight norm...
2025-12-07 16:43:50 - indextts - INFO - >> bigvgan weights restored from: nvidia/bigvgan_v2_22khz_80band_256x
2025-12-07 16:43:51,414 WETEXT INFO found existing fst: /home/admin-grant-jr/github/index-tts/indextts/utils/tagger_cache/zh_tn_tagger.fst
2025-12-07 16:43:51,414 WETEXT INFO                     /home/admin-grant-jr/github/index-tts/indextts/utils/tagger_cache/zh_tn_verbalizer.fst
2025-12-07 16:43:51,415 WETEXT INFO skip building fst for zh_normalizer ...
2025-12-07 16:43:49,601 WETEXT INFO found existing fst: /home/admin-grant-jr/github/index-tts/.venv/lib/python3.10/site-packages/tn/en_tn_tagger.fst
2025-12-07 16:43:49,602 WETEXT INFO                     /home/admin-grant-jr/github/index-tts/.venv/lib/python3.10/site-packages/tn/en_tn_verbalizer.fst
2025-12-07 16:43:49,602 WETEXT INFO skip building fst for en_normalizer ...
2025-12-07 16:43:50 - indextts - INFO - >> TextNormalizer loaded
2025-12-07 16:43:50 - indextts - INFO - >> bpe model loaded from: checkpoints/bpe.model
Model loaded successfully!
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8009 (Press CTRL+C to quit)
Cache hit: outputs/cache/602a43f2e743fd7660bf4122a90e0a37c39e43e6135d65c62a23762390ba6561.wav
INFO:     127.0.0.1:45286 - "POST /tts HTTP/1.1" 200 OK
Use the specified emotion vector
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:04<01:48,  4.50s/it] 12%|█▏        | 3/25 [00:10<01:13,  3.35s/it] 16%|█▌        | 4/25 [00:19<01:52,  5.37s/it] 20%|██        | 5/25 [00:27<02:05,  6.29s/it] 24%|██▍       | 6/25 [00:36<02:17,  7.24s/it] 28%|██▊       | 7/25 [00:44<02:09,  7.19s/it] 32%|███▏      | 8/25 [00:51<02:04,  7.33s/it] 36%|███▌      | 9/25 [01:00<02:06,  7.88s/it] 40%|████      | 10/25 [01:09<02:00,  8.06s/it] 44%|████▍     | 11/25 [01:16<01:47,  7.65s/it] 48%|████▊     | 12/25 [01:24<01:44,  8.05s/it] 52%|█████▏    | 13/25 [01:33<01:39,  8.30s/it] 56%|█████▌    | 14/25 [01:40<01:27,  7.94s/it] 60%|██████    | 15/25 [01:49<01:22,  8.27s/it] 64%|██████▍   | 16/25 [01:58<01:16,  8.49s/it] 68%|██████▊   | 17/25 [02:06<01:06,  8.32s/it] 72%|███████▏  | 18/25 [02:12<00:53,  7.61s/it] 76%|███████▌  | 19/25 [02:20<00:46,  7.72s/it] 80%|████████  | 20/25 [02:29<00:39,  7.92s/it] 84%|████████▍ | 21/25 [02:37<00:32,  8.16s/it] 88%|████████▊ | 22/25 [02:44<00:22,  7.54s/it] 92%|█████████▏| 23/25 [02:52<00:15,  7.73s/it] 96%|█████████▌| 24/25 [03:01<00:08,  8.17s/it]